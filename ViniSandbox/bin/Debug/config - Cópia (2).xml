<ViniSandbox>
	<StaticAnalysis>
		<Steps>
			<Step>
				<Path>cmd.exe</Path>
				<Args>/c Tools\AnalyzePe-Master\AnalyzePE.py -v {file} > Log\AnalyzePe.txt</Args>
				<LogPath>Log\AnalyzePe.txt</LogPath>							
				<LogHandlerAssembly>DefaultLogHandler.dll</LogHandlerAssembly>							
				<LogHandlerClass>ViniSandbox.PEAnalyzerLogHanlder</LogHandlerClass>
				<LogAll>false</LogAll>
				<LogAllName></LogAllName>
				<WaitExit>0</WaitExit>
				<WaitInit>0</WaitInit>
			</Step>
			<Step>
				<Path>Tools\VirusTotal.NET\VirusTotal.NET.exe</Path>
				<Args>\f {file} \out Log\VirusTotal.NET.txt</Args>
				<LogPath>Log\VirusTotal.NET.txt</LogPath>								
				<LogHandlerAssembly>DefaultLogHandler.dll</LogHandlerAssembly>								
				<LogHandlerClass>ViniSandbox.VirusTotalLogHandler</LogHandlerClass>
				<LogAll>false</LogAll>
				<LogAllName></LogAllName>
				<WaitExit>0</WaitExit>
				<WaitInit>0</WaitInit>
			</Step>
			<Step>
				<Path>Tools\FileDetails\FileDetails.exe</Path>
				<Args>\f {file} \out Log\FileDetails.txt</Args>
				<LogPath>Log\FileDetails.txt</LogPath>								
				<LogHandlerAssembly>DefaultLogHandler.dll</LogHandlerAssembly>								
				<LogHandlerClass>ViniSandbox.FileDetailsLogHandler</LogHandlerClass>
				<LogAll>false</LogAll>
				<LogAllName></LogAllName>
				<WaitExit>0</WaitExit>
				<WaitInit>0</WaitInit>
			</Step>
		</Steps>
	</StaticAnalysis>
	<DynamicAnalysis>
		<Virtualization>
			<SnapshotName>Clean</SnapshotName>
			<VMName>Windows 7 - Sandbox</VMName>						
			<VMControlAssembly>VMControl.dll</VMControlAssembly>						
			<VMControlClass>ViniSandbox.VBoxControl</VMControlClass>
			<Username>usuario</Username>
			<Password></Password>
			<Domain></Domain>
			<ViniSandboxToolsPath>C:\Files\Tools\ViniSandboxTools\ViniSandboxTools.exe</ViniSandboxToolsPath>
			<TempPath>C:\Users\Usuario\AppData\Local\Temp</TempPath>
		</Virtualization>
		<PreExecution>
			<Steps>
				<Step>
					<Path>C:\Files\Tools\FakeDnsServer\FakeDnsServer.exe</Path>
					<Args>\i 192.168.100.2 \l C:\Files\Logs\FakeDnsServer.txt</Args>
					<LogPath>C:\Files\Logs\FakeDnsServer.txt</LogPath>													
					<LogHandlerAssembly>DefaultLogHandler.dll</LogHandlerAssembly>				
					<LogHandlerClass>ViniSandbox.FakeDnsServerLogHandler</LogHandlerClass>
					<LogAll>false</LogAll>
					<LogAllName></LogAllName>
					<WaitExit>0</WaitExit>
					<WaitInit>0</WaitInit>
				</Step>
				<Step>
					<Path>C:\Files\Tools\ProcessMonitor\Procmon.exe</Path>
					<Args></Args>
					<LogPath>Log\Procmon.xml</LogPath>													
					<LogHandlerAssembly>DefaultLogHandler.dll</LogHandlerAssembly>				
					<LogHandlerClass>ViniSandbox.ProcessMonitorLogHandler</LogHandlerClass>
					<LogAll>false</LogAll>
					<LogAllName></LogAllName>
					<WaitExit>0</WaitExit>
					<WaitInit>0</WaitInit>
				</Step>
				<Step>
					<Path>C:\Tools\HandleDiff.exe</Path>
					<Args>-d -s 180 -f C:\Files\Logs\HandleDiff.txt</Args>
					<LogPath>C:\Files\Logs\HandleDiff.txt</LogPath>													
					<LogHandlerAssembly>DefaultLogHandler.dll</LogHandlerAssembly>				
					<LogHandlerClass>ViniSandbox.HandleDiffLogHandler</LogHandlerClass>
					<LogAll>false</LogAll>
					<LogAllName></LogAllName>
					<WaitExit>0</WaitExit>
					<WaitInit>0</WaitInit>
				</Step>
				<Step>
					<Path>C:\Tools\ViniSandboxTools\ViniSandboxTools.exe</Path>
					<Args>\ss C:\Files\Logs\ScreenShot01.jpeg</Args>
					<LogPath>C:\Files\Logs\ScreenShot01.jpeg</LogPath>													
					<LogHandlerAssembly></LogHandlerAssembly>				
					<LogHandlerClass></LogHandlerClass>
					<LogAll>true</LogAll>
					<LogAllName>ScreenShot01.jpeg</LogAllName>
					<WaitExit>0</WaitExit>
					<WaitInit>20000</WaitInit>
				</Step>
				<Step>
					<Path>C:\Tools\ViniSandboxTools\ViniSandboxTools.exe</Path>
					<Args>\ss C:\Files\Logs\ScreenShot02.jpeg</Args>
					<LogPath>C:\Files\Logs\ScreenShot02.jpeg</LogPath>													
					<LogHandlerAssembly></LogHandlerAssembly>				
					<LogHandlerClass></LogHandlerClass>
					<LogAll>true</LogAll>
					<LogAllName>ScreenShot02.jpeg</LogAllName>
					<WaitExit>0</WaitExit>
					<WaitInit>60000</WaitInit>
				</Step>
			</Steps>
		</PreExecution>
		<Execution>
			<Time>160</Time>
		</Execution>
		<PosExecution>
			<Steps>
				<Step>
					<Path></Path>
					<Args></Args>
					<LogPath></LogPath>
					<LogHandler></LogHandler>
					<LogAll>false</LogAll>
					<LogAllName></LogAllName>
					<WaitExit>0</WaitExit>
					<WaitInit>0</WaitInit>
				</Step>
			</Steps>
		</PosExecution>
	</DynamicAnalysis>
</ViniSandbox>